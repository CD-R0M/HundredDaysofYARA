rule Jupyter_infostealer_June_2022 {
  meta:
    author = "CD_R0M_"
    description = "Rule aims to detect multiple variants of Jupyter Infostealer (SolarMarker)"
    hash = "9d52082b5cb651b43b0f49e83354a11c5a200fd8"
    hash2 = "8c12f63dde4a40e6e52725525b381279b2c9772bbb159a514a372cb2d232e906"
    hash3 = "e99896598b6c6df29735f4c0f08c99ff49275cba850c81c1249e865b6f4f8ba8"
    hash4 = "5cf24553e521de102628e1ebdadb69a6623904f08b51cf5b1ea14779e03e8682"
    hash5 = "11543f09c416237d92090cebbefafdb2f03cec72a6f3fdedf8afe3c315181b5a"
	
  strings:
	  $a1 = "ReadAllText" ascii
	  $a2 = "MPB_" ascii wide
	  $a3 = "System.Convert" ascii
	  $b2 = "g988j988l988n988p988q988s888t888u888v888w888x888y888y888z888{888{888{888|888|888|888|888|888}888}888}888}888~888~888~888~889~889~889}889}899}899}899|899|899|899|899|888{988{899x" ascii
	  $b3 = "supportedOS Id=" ascii
	  $c1 = "IOSdyabisytda" wide fullword nocase
	  $c2 = "Random"
	  $c3 = "System.Management.Automation" ascii
	  $d1 = {636B51D73A1142BD0A75754D94B40C50B52610FE1DC86F916B0C96E71A5C48EF44E5BF9B61CD1591625AB8FF670B9C63FD366A81FA29F8DD2B7085DE0218F3786DBC7DF9C76D093DBE6A7687E98ABDF8845D1E76C9E4C676763A53D1D1D35A368FC6A3E12F1B3AB761D673EC4E6D338A7C5D452D4BB150E6413A375686DC93238DF75025E864E6DDD38F2F57B58720EB0E8E2CD523DAF44D7846E3038331294A5C0C318A4A8C88C5F7305AF914AF155F6C434909FD262353F68D63E81AAB5BB11D30C29B6982B4DBFC5654BC1FA187ABBE7A5B0A202F4B09C995A78DB2FAD6638B4EA5721CEE9F7A0173F819D6FE0D4984BD010203010001A38201B8308201B4300E0603551D0F0101}
	  $d2 = {0B277EC0A2F5A0E0DE223F0EFF7E95FBF3A3BA223E18AC11E4F099036D3B857C09D3EE5DC89A0B54E3A809716BE0CF22100F75CF71724E0AADDF403A5CB751E1A17914C64D2423305D}
	  $d3 = "COM+ Applications and ComponentsAppId" ascii
	  $d4 = {614D62462487638C91522CAF2989E5781FD60B14A580D7124770B375D59385937EB69267FB536189A8F56B96C0F458690D7CC801B1B92875B7996385228C61CA}
	  $e5 = {6561746500436F6D70696C657247656E657261746564417474726962757465004775696441747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B41747472696275746500416C6C6F774E756C6C41747472696275746500417373656D626C7946696C6556657273696F6E417474726962757465}
	  $e6 = {4465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F}
  condition:
    (all of ($a*) or all of ($b*) or all of ($c*) or all of ($d*) or all of ($e*))
}
